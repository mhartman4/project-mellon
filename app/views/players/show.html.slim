
br

p
  = link_to '< Back', players_path, :class=>"btn btn-primary"
h1 align="center"
  ="#{@player.name} - #{@player.games.pluck(:team).uniq.to_sentence}"

.btn-group align="center" style="padding: 10px 36%;"
  button.btn.btn-default.stat-selector.active type="button" id="fdp-selector" Fanduel Points
  button.btn.btn-default.stat-selector type="button" id="minutes-selector" Minutes
  button.btn.btn-default.stat-selector type="button" id="fdp-per-minute-selector" FDP / Minute
  button.btn.btn-default.stat-selector type="button" id="salary-selector" Salary

.chart id="fanduel-points"
.chart id="minutes"
.chart id="fdp-per-minute"
.chart id="salary"



h3 Game Log
table.table.table-hover
  thead
    tr
      th Date
      th Salary
      th FDP
      th Minutes

  tbody
    - @player.games.each do |game|
      tr
        td = link_to "#{game.game_day} - #{game.opponent}", game
        td = "$#{game.salary}"
        td = game.fanduel_points
        td = game.minutes

javascript:
  function renderChart(id, statName, chartData) {
    new Highcharts.Chart({
      chart: {
        renderTo: id
      },
      title: {
        text: statName
      },
      xAxis: {
        categories: #{ raw @player.games.reverse.collect {|game| game.game_day.strftime('%b %d') + ' ' + game.opponent}}

      },
      yAxis: {
        title: {
          text: statName
        },
        plotLines: [{
            color: '#FF0000',
            width: 2,
            value: jStat(chartData).mean()
        }]
      },
      tooltip: {
        formatter: function() {
          return this.x + ': ' + this.y
        }
      },
      series: [{
        name: statName,
        data: chartData
      }],
    })
  }

javascript:
  $(function() {
    renderChart("fanduel-points", "Fanduel Points", #{@player.games.reverse.collect {|game| (game.fanduel_points) }});
  });

javascript:
  $("div.chart:not(:first)").hide();
  $('.stat-selector').click(function() {
    $(".chart").hide();
  });

  $('#minutes-selector').click(function() {
    $("#fdp-selector").removeClass("active");
    $("#minutes").show();
    new Highcharts.Chart({
      chart: {
        renderTo: "minutes"
      },
      title: {
        text: "#{(@player.games.collect {|game| game.minutes}.inject(:+) / @player.games.length).round(2)} minutes per game"
      },
      xAxis: {
        categories: #{ raw @player.games.reverse.collect {|game| game.game_day.strftime('%b %d') + ' ' + game.opponent}}

      },
      yAxis: {
        title: {
          text: "Minutes"
        },
        plotLines: [{
            color: '#FF0000',
            width: 2,
            value: #{@player.games.collect {|game| game.minutes}.inject(:+) / @player.games.length}
        }]
      },
      tooltip: {
        formatter: function() {
          return this.x + ': ' + this.y
          //return '#{@player.games.collect}'
        }
      },
      series: [{
        name: "Minutes",
        data: #{@player.games.reverse.collect {|game| (game.minutes) }}
      }],
    });
  });

  $('#fdp-per-minute-selector').click(function() {
    $("#fdp-selector").removeClass("active");
    $("#fdp-per-minute").show();
    new Highcharts.Chart({
      chart: {
        renderTo: "fdp-per-minute"
      },
      title: {
        text: "#{(@player.games.collect {|game| game.fanduel_points / game.minutes}.inject(:+) / @player.games.length).round(2)} FDP / Minute"
      },
      xAxis: {
        categories: #{ raw @player.games.reverse.collect {|game| game.game_day.strftime('%b %d') + ' ' + game.opponent}}

      },
      yAxis: {
        title: {
          text: "FDP per Minute"
        },
        plotLines: [{
            color: '#FF0000',
            width: 2,
            value: #{@player.games.collect {|game| game.fanduel_points / game.minutes}.inject(:+) / @player.games.length}
        }]
      },
      tooltip: {
        formatter: function() {
          return this.x + ': ' + this.y
          //return '#{@player.games.collect}'
        }
      },
      series: [{
        name: "FDP per Minute",
        data: #{@player.games.reverse.collect {|game| (game.fanduel_points / game.minutes) }}
      }],
    })
  });

  $('#salary-selector').click(function() {
    $("#fdp-selector").removeClass("active");
    $("#salary").show();
    new Highcharts.Chart({
      chart: {
        renderTo: "salary"
      },
      title: {
        text: "Avg Salary: $#{number_with_delimiter((@player.games.collect {|game| game.salary}.inject(:+) / @player.games.length).round(0), :delimiter => ',')}"
      },
      xAxis: {
        categories: #{ raw @player.games.reverse.collect {|game| game.game_day.strftime('%b %d') + ' ' + game.opponent}}

      },
      yAxis: {
        title: {
          text: "Salary"
        },
        plotLines: [{
            color: '#FF0000',
            width: 2,
            value: #{@player.games.collect {|game| game.salary}.inject(:+) / @player.games.length}
        }]
      },
      tooltip: {
        formatter: function() {
          return this.x + ': ' + this.y
          //return '#{@player.games.collect}'
        }
      },
      series: [{
        name: "Salary",
        data: #{@player.games.reverse.collect {|game| (game.salary) }}
      }],
    })
  });

  $('#fdp-selector').click(function() {
    $("#fanduel-points").show();
  });

